!function o(a,s,c){function u(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[t]={exports:{}};a[t][0].call(i.exports,function(e){return u(a[t][1][e]||e)},i,i.exports,o,a,s,c)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<c.length;e++)u(c[e]);return u}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./game");document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector(".mode");e&&e.classList.add("hidden"),r.initGameFlyweb({clientMode:!0})})},{"./game":7}],2:[function(e,t,n){"use strict";var u=this&&this.__awaiter||function(o,a,s,c){return new(s||(s=Promise))(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((c=c.apply(o,a||[])).next())})},l=this&&this.__generator||function(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0});var h,r,f=e("./utils"),s=e("papaparse");(r=h=n.BoardPiece||(n.BoardPiece={}))[r.EMPTY=0]="EMPTY",r[r.PLAYER_1=1]="PLAYER_1",r[r.PLAYER_2=2]="PLAYER_2",r[r.DRAW=3]="DRAW";var d=function(e,t){this.winner=e,this.moves=t};n.Record=d;var i=function(){function c(e){this.gameRecord=[],this.csvData=[],this.starter=-1,this.turnOne=!0,this.turnTwo=!0,this.canvas=e,this.context=e.getContext("2d"),this.getBoardScale(),this.initConstants(),this.reset(),this.onresize(),console.log("making sure constructor is called once");for(var t={start:0,winner:0},n=0;n<42;n++)t["move_"+(n+1)]=[0,0];this.csvData.push(t);console.log("----Unparsed: ",s.unparse([["Hello","World!"],["Line","two"]]));var r=s.unparse({fields:["Column 1","Column 2"],data:[["foo","bar"],["abc","def"]]});console.log("after csv parse"),console.log(r)}return c.prototype.reset=function(){this.map=[],this.turnOne=!0,this.turnTwo=!0;for(var e=0;e<c.ROWS;e++){this.map.push([]);for(var t=0;t<c.COLUMNS;t++)this.map[e].push(h.EMPTY)}this.winnerBoardPiece=h.EMPTY,this.gameMoveRecord=[],f.Utils.clearCanvas(this)},c.prototype.getBoardScale=function(){return c.SCALE=window.innerWidth<640?.5:1},c.prototype.initConstants=function(){c.CANVAS_HEIGHT=480*c.SCALE,c.CANVAS_WIDTH=640*c.SCALE,c.PIECE_RADIUS=25*c.SCALE,c.MASK_X_BEGIN=Math.max(0,c.CANVAS_WIDTH-(3*c.COLUMNS+1)*c.PIECE_RADIUS)/2,c.MASK_Y_BEGIN=Math.max(0,c.CANVAS_HEIGHT-(3*c.ROWS+1)*c.PIECE_RADIUS)/2,c.MESSAGE_X_BEGIN=(c.CANVAS_WIDTH-(c.MESSAGE_WIDTH=400*c.SCALE))/2,c.MESSAGE_Y_BEGIN=20*c.SCALE,this.canvas.width=c.CANVAS_WIDTH,this.canvas.height=c.CANVAS_HEIGHT},c.prototype.onresize=function(){var e=this,t=c.SCALE;f.Utils.onresize().add(function(){e.getBoardScale(),t!==c.SCALE&&(t=c.SCALE,e.initConstants(),f.Utils.clearCanvas(e),e.render())})},c.prototype.applyPlayerAction=function(o,a){return u(this,void 0,void 0,function(){var t,n,r,i;return l(this,function(e){if(this.map[0][a]!==h.EMPTY||a<0||c.COLUMNS<=a)return[2,!1];for(t=!1,r=n=0;r<c.ROWS-1;r++)if(this.map[r+1][a]!==h.EMPTY){t=!0,n=r;break}return t||(n=c.ROWS-1),this.map[n][a]=o.boardPiece,this.debug(),i=[n,a],this.gameMoveRecord.push(i),this.render(),[2,!0]})})},c.prototype.debug=function(){},c.prototype.gameDone=function(e){var t=new d(e,this.gameMoveRecord),n={};n.start=this.starter,n.winner=e;for(var r=0;r<this.gameMoveRecord.length;r++)n["move_"+(r+1)]=this.gameMoveRecord[r];if(this.csvData.push(n),console.log("winner winner chicken dinner: "+e),console.log(this.gameMoveRecord),this.gameRecord.push(t),1e3==this.gameRecord.length){var i=s.unparse({fields:["Column 1","Column 2"],data:[["foo","bar"],["abc","def"]]});console.log("after the orginla one"),console.log(i);var o=s.unparse(this.csvData);console.log("after real csv parse"),console.log(o);var a=document.createElement("a");a.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(o)),a.setAttribute("download","datasetfive.csv"),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a)}},c.prototype.getWinner=function(){var o=this;if(this.winnerBoardPiece!==h.EMPTY)return this.winnerBoardPiece;for(var e=[[0,-1],[0,1],[-1,-1],[-1,0],[-1,1],[1,-1],[1,0],[1,1]],a=function(e,t,n,r,i){return 4<=i||!(e<0||t<0||c.ROWS<=e||c.COLUMNS<=t||o.map[e][t]!==n)&&a(e+r[0],t+r[1],n,r,i+1)},t=0,n=0;n<c.ROWS;n++)for(var r=0;r<c.COLUMNS;r++){var i=this.map[n][r];if(i!==h.EMPTY)for(var s=0;s<e.length;s++){if(a(n+e[s][0],r+e[s][1],i,e[s],1))return this.winnerBoardPiece=i}else t++}return 0===t?this.winnerBoardPiece=h.DRAW:h.EMPTY},c.prototype.announceWinner=function(){this.canvas.click()},c.prototype.getPlayerColor=function(e){switch(e){case h.PLAYER_1:return c.PLAYER_1_COLOR;case h.PLAYER_2:return c.PLAYER_2_COLOR;default:return"transparent"}},c.prototype.animateAction=function(o,a,s){return u(this,void 0,void 0,function(){var t,n,r,i=this;return l(this,function(e){switch(e.label){case 0:t=this.getPlayerColor(s),n=0,r=function(){return u(i,void 0,void 0,function(){return l(this,function(e){return f.Utils.clearCanvas(this),f.Utils.drawCircle(this.context,{x:3*c.PIECE_RADIUS*a+c.MASK_X_BEGIN+2*c.PIECE_RADIUS,y:n+c.MASK_Y_BEGIN+2*c.PIECE_RADIUS,r:c.PIECE_RADIUS,fillStyle:t,strokeStyle:c.PIECE_STROKE_STYLE}),this.render(),n+=c.PIECE_RADIUS,[2]})})},e.label=1;case 1:return n<=3*o*c.PIECE_RADIUS?[4,f.Utils.animationFrame()]:[3,3];case 2:return e.sent(),r(),[3,1];case 3:return[2]}})})},c.prototype.render=function(){f.Utils.drawMask(this);for(var e=0;e<c.ROWS;e++)for(var t=0;t<c.COLUMNS;t++)f.Utils.drawCircle(this.context,{x:3*c.PIECE_RADIUS*t+c.MASK_X_BEGIN+2*c.PIECE_RADIUS,y:3*c.PIECE_RADIUS*e+c.MASK_Y_BEGIN+2*c.PIECE_RADIUS,r:c.PIECE_RADIUS,fillStyle:this.getPlayerColor(this.map[e][t]),strokeStyle:c.PIECE_STROKE_STYLE})},c.ROWS=6,c.COLUMNS=7,c.PLAYER_1_COLOR="#ef453b",c.PLAYER_2_COLOR="#0059ff",c.PIECE_STROKE_STYLE="black",c.MASK_COLOR="#d8d8d8",c}();n.Board=i},{"./utils":14,papaparse:15}],3:[function(e,t,n){"use strict";var r=this&&this.__awaiter||function(o,a,s,c){return new(s||(s=Promise))(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((c=c.apply(o,a||[])).next())})},i=this&&this.__generator||function(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0});var o=e("../board"),a=function(){function e(e,t){this.gamesWon=[],this.board=new o.Board(t),this.players=e,this.currentPlayerId=0,this.reset()}return e.prototype.reset=function(){this.isMoveAllowed=!1,this.isGameWon=!1,this.board.reset(),this.board.render(),this.board.debug()},e.prototype.start=function(){return r(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:this.isMoveAllowed=!0,e.label=1;case 1:return this.isGameWon?[3,3]:[4,this.move()];case 2:return e.sent(),(t=this.board.getWinner())!==o.BoardPiece.EMPTY?(console.log("Game over: winner is player ",t),this.board.gameDone(t),console.log(this.board.gameRecord),this.isGameWon=!0,this.isMoveAllowed=!1,this.board.announceWinner(),[3,3]):[3,1];case 3:return[2]}})})},e.prototype.move=function(){return r(this,void 0,void 0,function(){var t,n,r;return i(this,function(e){switch(e.label){case 0:if(!this.isMoveAllowed)return[2];t=this.players[this.currentPlayerId],n=!1,e.label=1;case 1:return n?[3,4]:[4,t.getAction(this.board)];case 2:return r=e.sent(),this.isMoveAllowed=!1,[4,this.board.applyPlayerAction(t,r)];case 3:return n=e.sent(),this.isMoveAllowed=!0,n?this.afterMove(r):console.log("Move not allowed! Try again."),[3,1];case 4:return this.currentPlayerId=this.getNextPlayer(),[2]}})})},e.prototype.afterMove=function(e){},e.prototype.getNextPlayer=function(){return 0===this.currentPlayerId?1:0},e}();n.GameBase=a},{"../board":2}],4:[function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__awaiter||function(o,a,s,c){return new(s||(s=Promise))(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((c=c.apply(o,a||[])).next())})},c=this&&this.__generator||function(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0});var i=e("./game-base"),u=e("../player"),l=e("../board"),h=e("../utils"),f=function(i){function e(e,t,n){void 0===n&&(n=!1);var r=i.call(this,e,t)||this;return r.BASE_URL=window.location.pathname.substring(0,window.location.pathname.lastIndexOf("/")),r.browser=navigator,r.isAcceptingPlayer=!0,(r.clientMode=n)?(r.playerSlave=e[0],r.playerMaster=e[1],r.initClient()):(r.playerMaster=e[0],r.playerSlave=e[1],r.initServer()),r}return o(e,i),e.prototype.afterMove=function(e){(this.clientMode&&1===this.currentPlayerId||!this.clientMode&&0===this.currentPlayerId)&&this.playerMaster.socket.send(JSON.stringify({type:"move",data:{column:e,from:0===this.currentPlayerId?"server":"client"}}))},e.prototype.initClient=function(){this.handleClientWs()},e.prototype.handleClientWs=function(){var e=this,t=new WebSocket("ws://"+window.location.host+"/api/ws");(this.playerMaster.socket=t).onopen=function(e){console.log("client socket.onopen()",e)},t.onclose=function(e){console.log("client socket.onclose()",e)},t.onerror=function(e){console.log("client socket.onerror()",e),t.close()},t.onmessage=function(n){return s(e,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return console.log("client socket.onmessage()",n),(t=JSON.parse(n.data))?"client"===t.from?[2]:"start"!==t.type?[3,1]:(h.Utils.showMessage("<h1>Welcome!</h1>Connection to Player 1 has been established. Game started!"),this.start(),[3,4]):[2];case 1:return"move"!==t.type?[3,2]:(this.playerSlave.doAction(t.data.column),[3,4]);case 2:return"reset"!==t.type?[3,4]:(this.reset(),[4,h.Utils.animationFrame()]);case 3:e.sent(),this.start(),e.label=4;case 4:return[2]}})})}},e.prototype.fetch=function(o,a){return s(this,void 0,void 0,function(){var t,n,r,i;return c(this,function(e){switch(e.label){case 0:return[4,fetch(this.BASE_URL+a)];case 1:return t=e.sent(),n=t.headers.get("Content-Type"),[4,t.blob()];case 2:return r=e.sent(),i={"Content-Type":n,"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:0},console.log("Response is: ",a),o.respondWith(new Promise(function(e){return e(new Response(r,{headers:i}))})),[2]}})})},e.prototype.handleWsServer=function(e){var t=this,n=e.accept();(this.playerMaster.socket=n).onopen=function(e){console.log("server socket.onopen()",e,n),t.isAcceptingPlayer?(t.isAcceptingPlayer=!1,n.send(JSON.stringify({type:"start",data:{accepted:t.isAcceptingPlayer}})),h.Utils.showMessage("<h1>Welcome!</h1>Connection to Player 2 has been established. Game started!"),t.start()):n.close()},n.onclose=function(e){console.log("server socket.onclose()",e),t.isAcceptingPlayer=!0,t.reset()},n.onerror=function(e){console.log("server socket.onerror()",e),t.isAcceptingPlayer=!0,n.close()},n.onmessage=function(n){return s(t,void 0,void 0,function(){var t;return c(this,function(e){switch(e.label){case 0:return console.log("server socket.onmessage()",n),(t=JSON.parse(n.data))?"server"===t.from?[2]:"move"!==t.type?[3,1]:(this.playerSlave.doAction(t.data.column),[3,3]):[2];case 1:return"reset"!==t.type?[3,3]:(this.reset(),[4,h.Utils.animationFrame()]);case 2:e.sent(),this.start(),e.label=3;case 3:return[2]}})})}},e.prototype.initServer=function(){return s(this,void 0,void 0,function(){var t,n=this;return c(this,function(e){switch(e.label){case 0:return"publishServer"in this.browser?[4,this.browser.publishServer("c4 - Connect Four")]:(h.Utils.showMessage('<h1>Attention!</h1>\n        FlyWeb requires Firefox Developer Edition or Nightly,\n        and enabling "dom.flyweb.enabled" flag at about:config'),[2,!1]);case 1:return(t=e.sent()).onfetch=function(i){return s(n,void 0,void 0,function(){var t,n,r;return c(this,function(e){switch(e.label){case 0:switch(t=i.request.url.split("?"),n=t[0],r=new URLSearchParams(t[1]),console.log("me Requested for url: ",n,r),n){case"/dist/app.js":return[3,1]}return[3,3];case 1:return[4,this.fetch(i,"/dist/app-flyweb-client.js")];case 2:return e.sent(),[3,5];case 3:return[4,this.fetch(i,n)];case 4:e.sent(),e.label=5;case 5:return[2]}})})},t.onwebsocket=function(e){"/api/ws"===e.request.url&&n.handleWsServer(e)},[2]}})})},e}(i.GameBase);n.initGameFlyweb=function(e){var t=this,n=e.clientMode,r=void 0!==n&&n,i=document.querySelector("canvas");if(i){var o=[];o=r?[new u.PlayerFlywebSlave(l.BoardPiece.PLAYER_1,i),new u.PlayerFlywebMaster(l.BoardPiece.PLAYER_2,i)]:[new u.PlayerFlywebMaster(l.BoardPiece.PLAYER_1,i),new u.PlayerFlywebSlave(l.BoardPiece.PLAYER_2,i)];var a=new f(o,i,r);h.Utils.showMessage("<h1>Welcome!</h1>Game will start after Player 2 has been connected."),i.addEventListener("click",function(){return s(t,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return a.isGameWon?(a.reset(),a.playerMaster&&a.playerMaster.socket&&a.playerMaster.socket.send(JSON.stringify({type:"reset",data:{reset:!0}})),[4,h.Utils.animationFrame()]):[3,2];case 1:e.sent(),a.start(),e.label=2;case 2:return[2]}})})})}else console.error("Canvas DOM is null")}},{"../board":2,"../player":8,"../utils":14,"./game-base":3}],5:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(o,a,s,c){return new(s||(s=Promise))(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((c=c.apply(o,a||[])).next())})},a=this&&this.__generator||function(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("../board"),c=e("./game-base"),u=e("../player"),l=e("../utils"),h=function(n){function e(e,t){return n.call(this,e,t)||this}return i(e,n),e}(c.GameBase);n.initGameLocal2p=function(){var e=this,t=document.querySelector("canvas");if(t){var n=new h([new u.PlayerHuman(s.BoardPiece.PLAYER_1,t),new u.PlayerHuman(s.BoardPiece.PLAYER_2,t)],t);n.start(),t.addEventListener("click",function(){return o(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return n.isGameWon?(n.reset(),[4,l.Utils.animationFrame()]):[3,2];case 1:e.sent(),n.start(),e.label=2;case 2:return[2]}})})})}else console.error("Canvas DOM is null")}},{"../board":2,"../player":8,"../utils":14,"./game-base":3}],6:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(o,a,s,c){return new(s||(s=Promise))(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((c=c.apply(o,a||[])).next())})},a=this&&this.__generator||function(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("../board"),c=e("./game-base"),u=e("../player"),l=e("../utils"),h=function(n){function e(e,t){return n.call(this,e,t)||this}return i(e,n),e}(c.GameBase);n.initGameLocalAi=function(){var e=this,t=document.querySelector("canvas");if(t){var n=new h([new u.PlayerAi(s.BoardPiece.PLAYER_1,t),new u.PlayerAi(s.BoardPiece.PLAYER_2,t)],t);n.start(),t.addEventListener("click",function(){return o(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return n.isGameWon?(console.log("----------------- wow"),n.reset(),[4,l.Utils.animationFrame()]):[3,2];case 1:e.sent(),n.start(),e.label=2;case 2:return[2]}})})})}else console.error("Canvas DOM is null")}},{"../board":2,"../player":8,"../utils":14,"./game-base":3}],7:[function(e,t,n){"use strict";function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),r(e("./game-flyweb")),r(e("./game-local-2p")),r(e("./game-local-ai"))},{"./game-flyweb":4,"./game-local-2p":5,"./game-local-ai":6}],8:[function(e,t,n){"use strict";function r(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),r(e("./player")),r(e("./player-ai")),r(e("./player-human")),r(e("./player-flyweb-master")),r(e("./player-flyweb-slave"))},{"./player":13,"./player-ai":9,"./player-flyweb-master":10,"./player-flyweb-slave":11,"./player-human":12}],9:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(o,a,s,c){return new(s||(s=Promise))(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((c=c.apply(o,a||[])).next())})},a=this&&this.__generator||function(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./player"),f=e("../board"),d=e("../utils"),c=function(r){function s(e,t){var n=r.call(this,e,t)||this;return n.ownBoardPieceValue=n.getBoardPieceValue(e),n.enemyBoardPiece=e===f.BoardPiece.PLAYER_1?f.BoardPiece.PLAYER_2:f.BoardPiece.PLAYER_1,n}return i(s,r),s.prototype.getBoardPieceValue=function(e){return e===f.BoardPiece.EMPTY?0:e===this.boardPiece?1:-1},s.prototype.getStateValue=function(e){for(var t=f.BoardPiece.EMPTY,n=0,r=0;r<f.Board.ROWS;r++)for(var i=0;i<f.Board.COLUMNS;i++){for(var o=0,a=0,s=0,c=0,u=0;u<=3;u++)i+u<f.Board.COLUMNS&&(o+=this.getBoardPieceValue(e[r][i+u])),r+u<f.Board.ROWS&&(a+=this.getBoardPieceValue(e[r+u][i])),r+u<f.Board.ROWS&&i+u<f.Board.COLUMNS&&(s+=this.getBoardPieceValue(e[r+u][i+u])),0<=r-u&&i+u<7&&(c+=this.getBoardPieceValue(e[r-u][i+u]));n+=o*o*o,n+=a*a*a,n+=s*s*s,n+=c*c*c,4===Math.abs(o)?t=0<o?this.boardPiece:this.enemyBoardPiece:4===Math.abs(a)?t=0<a?this.boardPiece:this.enemyBoardPiece:4===Math.abs(s)?t=0<s?this.boardPiece:this.enemyBoardPiece:4===Math.abs(c)&&(t=0<c?this.boardPiece:this.enemyBoardPiece)}return{winnerBoardPiece:t,chain:n}},s.prototype.transformValues=function(e,t,n){var r=t===this.boardPiece,i=t===this.enemyBoardPiece;return r?e=d.Utils.BIG_POSITIVE_NUMBER-100:i&&(e=d.Utils.BIG_NEGATIVE_NUMBER+100),e-=n*n},s.prototype.getMove=function(e,t,n,r){var i=this.getStateValue(e),o=i.winnerBoardPiece===this.boardPiece,a=i.winnerBoardPiece===this.enemyBoardPiece;return s.MAX_DEPTH<=t||o||a?{value:this.transformValues(i.chain*this.ownBoardPieceValue,i.winnerBoardPiece,t),move:-1}:t%2==0?this.minState(e,t+1,n,r):this.maxState(e,t+1,n,r)},s.prototype.maxState=function(e,t,n,r){for(var i=d.Utils.BIG_NEGATIVE_NUMBER,o=[],a=0;a<f.Board.COLUMNS;a++){var s=d.Utils.getMockPlayerAction(e,this.boardPiece,a),c=s.success,u=s.map;if(c){var l=this.getMove(u,t,n,r),h=l.value;l.move;if(i<h?(i=h,o=[a]):h===i&&o.push(a),r<i)return{value:i,move:d.Utils.choose(o)};n=Math.max(n,i)}}return{value:i,move:d.Utils.choose(o)}},s.prototype.minState=function(e,t,n,r){for(var i=d.Utils.BIG_POSITIVE_NUMBER,o=[],a=0;a<f.Board.COLUMNS;a++){var s=d.Utils.getMockPlayerAction(e,this.enemyBoardPiece,a),c=s.success,u=s.map;if(c){var l=this.getMove(u,t,n,r),h=l.value;l.move;if(h<i?(i=h,o=[a]):h===i&&o.push(a),i<n)return{value:i,move:d.Utils.choose(o)};r=Math.min(r,i)}}return{value:i,move:d.Utils.choose(o)}},s.prototype.getAction=function(r){return o(this,void 0,void 0,function(){var t,n;return a(this,function(e){return t=d.Utils.clone(r.map),n=this.maxState(t,0,d.Utils.BIG_NEGATIVE_NUMBER,d.Utils.BIG_POSITIVE_NUMBER),console.log("AI "+this.boardPiece+" choose STEVEN column "+n.move+" with "+r.turnTwo+" value of "+n.value),r.turnOne&&(console.log("started the game: "+this.boardPiece),r.starter=this.boardPiece),r.turnTwo?(r.turnTwo=r.turnOne,r.turnOne=!1,console.log("set turnOne to false"),[2,Math.floor(7*Math.random())]):[2,n.move]})})},s.MAX_DEPTH=4,s}(s.Player);n.PlayerAi=c},{"../board":2,"../utils":14,"./player":13}],10:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(o,a,s,c){return new(s||(s=Promise))(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((c=c.apply(o,a||[])).next())})},a=this&&this.__generator||function(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0});var s=function(r){function e(e,t){var n=r.call(this,e,t)||this;return n.clickPromiseResolver=null,n}return i(e,r),e.prototype.doAction=function(e){if(r.prototype.doAction.call(this,e),!this.socket)throw Error("PlayerFlywebMaster need WebSocket object")},e.prototype.getAction=function(e){return o(this,void 0,void 0,function(){var t=this;return a(this,function(e){return[2,new Promise(function(e){return t.clickPromiseResolver=e})]})})},e}(e(".").PlayerHuman);n.PlayerFlywebMaster=s},{".":8}],11:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(o,a,s,c){return new(s||(s=Promise))(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((c=c.apply(o,a||[])).next())})},a=this&&this.__generator||function(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0});var s=function(r){function e(e,t){var n=r.call(this,e,t)||this;return n.actionPromiseResolver=null,n}return i(e,r),e.prototype.doAction=function(e){this.actionPromiseResolver&&this.actionPromiseResolver(e)},e.prototype.getAction=function(e){return o(this,void 0,void 0,function(){var t=this;return a(this,function(e){return[2,new Promise(function(e){return t.actionPromiseResolver=e})]})})},e}(e("./player").Player);n.PlayerFlywebSlave=s},{"./player":13}],12:[function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(o,a,s,c){return new(s||(s=Promise))(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function r(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((c=c.apply(o,a||[])).next())})},a=this&&this.__generator||function(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./player"),c=e("../board"),u=e("../utils"),l=function(r){function e(e,t){var n=r.call(this,e,t)||this;return n.clickPromiseResolver=null,t.addEventListener("click",function(e){try{n.handleClick(e)}catch(e){console.error(e)}}),n}return i(e,r),e.prototype.doAction=function(e){this.clickPromiseResolver&&0<=e&&e<c.Board.COLUMNS&&this.clickPromiseResolver(e)},e.prototype.handleClick=function(e){var t=this.canvas.getBoundingClientRect(),n=e.clientX-t.left,r=e.clientY-t.top,i=u.Utils.getColumnFromCoord({x:n,y:r});this.doAction(i)},e.prototype.getAction=function(e){return o(this,void 0,void 0,function(){var t=this;return a(this,function(e){return[2,new Promise(function(e){return t.clickPromiseResolver=e})]})})},e}(s.Player);n.PlayerHuman=l},{"../board":2,"../utils":14,"./player":13}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(e,t){this.boardPiece=e,this.canvas=t};n.Player=r},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var c=e("./board"),r=function(){function s(){}return s.showMessage=function(e){void 0===e&&(e="");var t=document.querySelector(".message");if(t){t.classList.remove("hidden");var n=document.querySelector(".message-body-content");if(n){n.innerHTML=e;var r=document.querySelector(".message-body-dismiss");if(r){var i=function(){t.classList.add("invisible"),t.addEventListener("transitionend",function(){t.classList.add("hidden"),t.classList.remove("invisible")}),r.removeEventListener("click",i)};r.addEventListener("click",i)}else console.error("Message body dismiss DOM is null!")}else console.error("Message body content DOM is null!")}else console.error("Message DOM is null!")},s.drawCircle=function(e,t){var n=t.x,r=void 0===n?0:n,i=t.y,o=void 0===i?0:i,a=t.r,s=void 0===a?0:a,c=t.fillStyle,u=void 0===c?"":c,l=t.strokeStyle,h=void 0===l?"":l;e.save(),e.fillStyle=u,e.strokeStyle=h,e.beginPath(),e.arc(r,o,s,0,2*Math.PI,!1),e.fill(),e.restore()},s.drawMask=function(e){var t=e.context;t.save(),t.fillStyle=c.Board.MASK_COLOR,t.beginPath();for(var n=2*c.Board.PIECE_RADIUS,r=3*c.Board.PIECE_RADIUS,i=0;i<c.Board.ROWS;i++)for(var o=0;o<c.Board.COLUMNS;o++)t.arc(r*o+c.Board.MASK_X_BEGIN+n,r*i+c.Board.MASK_Y_BEGIN+n,c.Board.PIECE_RADIUS,0,2*Math.PI),t.rect(r*o+c.Board.MASK_X_BEGIN+2*n,r*i+c.Board.MASK_Y_BEGIN,-2*n,2*n);t.fill(),t.restore()},s.clearCanvas=function(e){e.context.clearRect(0,0,e.canvas.width,e.canvas.height)},s.isCoordOnColumn=function(e,t,n){return(e.x-t)*(e.x-t)<=n*n},s.getColumnFromCoord=function(e){for(var t=0;t<c.Board.COLUMNS;t++)if(s.isCoordOnColumn(e,3*c.Board.PIECE_RADIUS*t+c.Board.MASK_X_BEGIN+2*c.Board.PIECE_RADIUS,c.Board.PIECE_RADIUS))return t;return-1},s.getRandomColumnNumber=function(){return Math.floor(Math.random()*c.Board.COLUMNS)},s.choose=function(e){return e[Math.floor(Math.random()*e.length)]},s.animationFrame=function(){var t=null,e=new Promise(function(e){return t=e});return t&&window.requestAnimationFrame(t),e},s.clone=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n].slice();return t},s.getMockPlayerAction=function(e,t,n){var r=s.clone(e);if(r[0][n]!==c.BoardPiece.EMPTY||n<0||n>=c.Board.COLUMNS)return{success:!1,map:r};for(var i=!1,o=0,a=0;a<c.Board.ROWS-1;a++)if(r[a+1][n]!==c.BoardPiece.EMPTY){i=!0,o=a;break}return i||(o=c.Board.ROWS-1),r[o][n]=t,{success:!0,map:r}},s.onresize=function(){var n=[],e=!1;function r(){e||(e=!0,window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,66))}function t(){n.forEach(function(e){e()}),e=!1}return{add:function(e){var t;n.length||window.addEventListener("resize",r),(t=e)&&n.push(t)}}},s.BIG_POSITIVE_NUMBER=Math.pow(10,9)+7,s.BIG_NEGATIVE_NUMBER=-s.BIG_POSITIVE_NUMBER,s}();n.Utils=r},{"./board":2}],15:[function(e,t,n){var r,i;r=this,i=function(){"use strict";var o,e,l="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==l?l:{},i=!l.document&&!!l.postMessage,s=i&&/(\?|&)papaworker(=|&|$)/.test(l.location.search),a=!1,c={},u=0,v={parse:function(e,t){var n=(t=t||{}).dynamicTyping||!1;U(n)&&(t.dynamicTypingFunction=n,n={});if(t.dynamicTyping=n,t.worker&&v.WORKERS_SUPPORTED){var r=function(){if(!v.WORKERS_SUPPORTED)return!1;if(!a&&null===v.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var e=v.SCRIPT_PATH||o;e+=(-1!==e.indexOf("?")?"&":"?")+"papaworker";var t=new l.Worker(e);return t.onmessage=b,t.id=u++,c[t.id]=t}();return r.userStep=t.step,r.userChunk=t.chunk,r.userComplete=t.complete,r.userError=t.error,t.step=U(t.step),t.chunk=U(t.chunk),t.complete=U(t.complete),t.error=U(t.error),delete t.worker,void r.postMessage({input:e,config:t,workerId:r.id})}var i=null;"string"==typeof e?i=t.download?new d(t):new y(t):!0===e.readable&&U(e.read)&&U(e.on)?i=new _(t):(l.File&&e instanceof File||e instanceof Object)&&(i=new p(t));return i.stream(e)},unparse:function(e,t){var r=!1,l=!0,h=",",f="\r\n",i='"';!function(){if("object"!=typeof t)return;"string"==typeof t.delimiter&&1===t.delimiter.length&&-1===v.BAD_DELIMITERS.indexOf(t.delimiter)&&(h=t.delimiter);("boolean"==typeof t.quotes||t.quotes instanceof Array)&&(r=t.quotes);"string"==typeof t.newline&&(f=t.newline);"string"==typeof t.quoteChar&&(i=t.quoteChar);"boolean"==typeof t.header&&(l=t.header)}();var o=new RegExp(i,"g");"string"==typeof e&&(e=JSON.parse(e));if(e instanceof Array){if(!e.length||e[0]instanceof Array)return a(null,e);if("object"==typeof e[0])return a(n(e[0]),e)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),e.data instanceof Array&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=e.data[0]instanceof Array?e.fields:n(e.data[0])),e.data[0]instanceof Array||"object"==typeof e.data[0]||(e.data=[e.data])),a(e.fields||[],e.data||[]);throw"exception: Unable to serialize unrecognized input";function n(e){if("object"!=typeof e)return[];var t=[];for(var n in e)t.push(n);return t}function a(e,t){var n="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var r=e instanceof Array&&0<e.length,i=!(t[0]instanceof Array);if(r&&l){for(var o=0;o<e.length;o++)0<o&&(n+=h),n+=d(e[o],o);0<t.length&&(n+=f)}for(var a=0;a<t.length;a++){for(var s=r?e.length:t[a].length,c=0;c<s;c++){0<c&&(n+=h);var u=r&&i?e[c]:c;n+=d(t[a][u],c)}a<t.length-1&&(n+=f)}return n}function d(e,t){if(null==e)return"";e=e.toString().replace(o,i+i);var n="boolean"==typeof r&&r||r instanceof Array&&r[t]||function(e,t){for(var n=0;n<t.length;n++)if(-1<e.indexOf(t[n]))return!0;return!1}(e,v.BAD_DELIMITERS)||-1<e.indexOf(h)||" "===e.charAt(0)||" "===e.charAt(e.length-1);return n?i+e+i:e}}};if(v.RECORD_SEP=String.fromCharCode(30),v.UNIT_SEP=String.fromCharCode(31),v.BYTE_ORDER_MARK="\ufeff",v.BAD_DELIMITERS=["\r","\n",'"',v.BYTE_ORDER_MARK],v.WORKERS_SUPPORTED=!i&&!!l.Worker,v.SCRIPT_PATH=null,v.LocalChunkSize=10485760,v.RemoteChunkSize=5242880,v.DefaultDelimiter=",",v.Parser=m,v.ParserHandle=n,v.NetworkStreamer=d,v.FileStreamer=p,v.StringStreamer=y,v.ReadableStreamStreamer=_,l.jQuery){var h=l.jQuery;h.fn.parse=function(s){var n=s.config||{},c=[];return this.each(function(e){if(!("INPUT"===h(this).prop("tagName").toUpperCase()&&"file"===h(this).attr("type").toLowerCase()&&l.FileReader)||!this.files||0===this.files.length)return!0;for(var t=0;t<this.files.length;t++)c.push({file:this.files[t],inputElem:this,instanceConfig:h.extend({},n)})}),e(),this;function e(){if(0!==c.length){var e,t,n,r,i=c[0];if(U(s.before)){var o=s.before(i.file,i.inputElem);if("object"==typeof o){if("abort"===o.action)return e="AbortError",t=i.file,n=i.inputElem,r=o.reason,void(U(s.error)&&s.error({name:e},t,n,r));if("skip"===o.action)return void u();"object"==typeof o.config&&(i.instanceConfig=h.extend(i.instanceConfig,o.config))}else if("skip"===o)return void u()}var a=i.instanceConfig.complete;i.instanceConfig.complete=function(e){U(a)&&a(e,i.file,i.inputElem),u()},v.parse(i.file,i.instanceConfig)}else U(s.complete)&&s.complete()}function u(){c.splice(0,1),e()}}}function f(e){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=P(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null);this._handle=new n(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){if(this.isFirstChunk&&U(this._config.beforeFirstChunk)){var n=this._config.beforeFirstChunk(e);void 0!==n&&(e=n)}this.isFirstChunk=!1;var r=this._partialLine+e;this._partialLine="";var i=this._handle.parse(r,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var o=i.meta.cursor;this._finished||(this._partialLine=r.substring(o-this._baseIndex),this._baseIndex=o),i&&i.data&&(this._rowCount+=i.data.length);var a=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s)l.postMessage({results:i,workerId:v.WORKER_ID,finished:a});else if(U(this._config.chunk)&&!t){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return;i=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!a||!U(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),a||i&&i.meta.paused||this._nextChunk(),i}},this._sendError=function(e){U(this._config.error)?this._config.error(e):s&&this._config.error&&l.postMessage({workerId:v.WORKER_ID,error:e,finished:!1})}}function d(e){var r;(e=e||{}).chunkSize||(e.chunkSize=v.RemoteChunkSize),f.call(this,e),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(r=new XMLHttpRequest,this._config.withCredentials&&(r.withCredentials=this._config.withCredentials),i||(r.onload=E(this._chunkLoaded,this),r.onerror=E(this._chunkError,this)),r.open("GET",this._input,!i),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var t in e)r.setRequestHeader(t,e[t])}if(this._config.chunkSize){var n=this._start+this._config.chunkSize-1;r.setRequestHeader("Range","bytes="+this._start+"-"+n),r.setRequestHeader("If-None-Match","webkit-no-cache")}try{r.send()}catch(e){this._chunkError(e.message)}i&&0===r.status?this._chunkError():this._start+=this._config.chunkSize}},this._chunkLoaded=function(){4===r.readyState&&(r.status<200||400<=r.status?this._chunkError():(this._finished=!this._config.chunkSize||this._start>function(e){var t=e.getResponseHeader("Content-Range");if(null===t)return-1;return parseInt(t.substr(t.lastIndexOf("/")+1))}(r),this.parseChunk(r.responseText)))},this._chunkError=function(e){var t=r.statusText||e;this._sendError(new Error(t))}}function p(e){var r,i;(e=e||{}).chunkSize||(e.chunkSize=v.LocalChunkSize),f.call(this,e);var o="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,i=e.slice||e.webkitSlice||e.mozSlice,o?((r=new FileReader).onload=E(this._chunkLoaded,this),r.onerror=E(this._chunkError,this)):r=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var t=Math.min(this._start+this._config.chunkSize,this._input.size);e=i.call(e,this._start,t)}var n=r.readAsText(e,this._config.encoding);o||this._chunkLoaded({target:{result:n}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(r.error)}}function y(e){var n;f.call(this,e=e||{}),this.stream=function(e){return n=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e=this._config.chunkSize,t=e?n.substr(0,e):n;return n=e?n.substr(e):"",this._finished=!n,this.parseChunk(t)}}}function _(e){f.call(this,e=e||{});var t=[],n=!0,r=!1;this.pause=function(){f.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){f.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):n=!0},this._streamData=E(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=E(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=E(function(){this._streamCleanUp(),r=!0,this._streamData("")},this),this._streamCleanUp=E(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function n(y){var o,a,s,r=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,t=this,n=0,c=!1,e=!1,u=[],l={data:[],errors:[],meta:{}};if(U(y.step)){var i=y.step;y.step=function(e){if(l=e,f())h();else{if(h(),0===l.data.length)return;n+=e.data.length,y.preview&&n>y.preview?a.abort():i(l,t)}}}function h(){if(l&&s&&(p("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+v.DefaultDelimiter+"'"),s=!1),y.skipEmptyLines)for(var e=0;e<l.data.length;e++)1===l.data[e].length&&""===l.data[e][0]&&l.data.splice(e--,1);return f()&&function(){if(!l)return;for(var e=0;f()&&e<l.data.length;e++)for(var t=0;t<l.data[e].length;t++){var n=l.data[e][t];y.trimHeaders&&(n=n.trim()),u.push(n)}l.data.splice(0,1)}(),function(){if(!l||!y.header&&!y.dynamicTyping)return l;for(var e=0;e<l.data.length;e++){var t,n=y.header?{}:[];for(t=0;t<l.data[e].length;t++){var r=t,i=l.data[e][t];y.header&&(r=t>=u.length?"__parsed_extra":u[t]),i=d(r,i),"__parsed_extra"===r?(n[r]=n[r]||[],n[r].push(i)):n[r]=i}l.data[e]=n,y.header&&(t>u.length?p("FieldMismatch","TooManyFields","Too many fields: expected "+u.length+" fields but parsed "+t,e):t<u.length&&p("FieldMismatch","TooFewFields","Too few fields: expected "+u.length+" fields but parsed "+t,e))}y.header&&l.meta&&(l.meta.fields=u);return l}()}function f(){return y.header&&0===u.length}function d(e,t){return n=e,y.dynamicTypingFunction&&void 0===y.dynamicTyping[n]&&(y.dynamicTyping[n]=y.dynamicTypingFunction(n)),!0===(y.dynamicTyping[n]||y.dynamicTyping)?"true"===t||"TRUE"===t||"false"!==t&&"FALSE"!==t&&(r.test(t)?parseFloat(t):""===t?null:t):t;var n}function p(e,t,n,r){l.errors.push({type:e,code:t,message:n,row:r})}this.parse=function(e,t,n){if(y.newline||(y.newline=function(e){var t=(e=e.substr(0,1048576)).split("\r"),n=e.split("\n"),r=1<n.length&&n[0].length<t[0].length;if(1===t.length||r)return"\n";for(var i=0,o=0;o<t.length;o++)"\n"===t[o][0]&&i++;return i>=t.length/2?"\r\n":"\r"}(e)),s=!1,y.delimiter)U(y.delimiter)&&(y.delimiter=y.delimiter(e),l.meta.delimiter=y.delimiter);else{var r=function(e,t,n){for(var r,i,o,a=[",","\t","|",";",v.RECORD_SEP,v.UNIT_SEP],s=0;s<a.length;s++){var c=a[s],u=0,l=0,h=0;o=void 0;for(var f=new m({delimiter:c,newline:t,preview:10}).parse(e),d=0;d<f.data.length;d++)if(n&&1===f.data[d].length&&0===f.data[d][0].length)h++;else{var p=f.data[d].length;l+=p,void 0!==o?1<p&&(u+=Math.abs(p-o),o=p):o=p}0<f.data.length&&(l/=f.data.length-h),(void 0===i||u<i)&&1.99<l&&(i=u,r=c)}return{successful:!!(y.delimiter=r),bestDelimiter:r}}(e,y.newline,y.skipEmptyLines);r.successful?y.delimiter=r.bestDelimiter:(s=!0,y.delimiter=v.DefaultDelimiter),l.meta.delimiter=y.delimiter}var i=P(y);return y.preview&&y.header&&i.preview++,o=e,a=new m(i),l=a.parse(o,t,n),h(),c?{meta:{paused:!0}}:l||{meta:{paused:!1}}},this.paused=function(){return c},this.pause=function(){c=!0,a.abort(),o=o.substr(a.getCharIndex())},this.resume=function(){c=!1,t.streamer.parseChunk(o,!0)},this.aborted=function(){return e},this.abort=function(){e=!0,a.abort(),l.meta.aborted=!0,U(y.complete)&&y.complete(l),o=""}}function m(e){var k,R=(e=e||{}).delimiter,M=e.newline,O=e.comments,A=e.step,I=e.preview,x=e.fastMode,B=k=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(B=e.escapeChar),("string"!=typeof R||-1<v.BAD_DELIMITERS.indexOf(R))&&(R=","),O===R)throw"Comment character same as delimiter";!0===O?O="#":("string"!=typeof O||-1<v.BAD_DELIMITERS.indexOf(O))&&(O=!1),"\n"!==M&&"\r"!==M&&"\r\n"!==M&&(M="\n");var L=0,T=!1;this.parse=function(r,t,n){if("string"!=typeof r)throw"Input must be a string";var i=r.length,e=R.length,o=M.length,a=O.length,s=U(A),c=[],u=[],l=[],h=L=0;if(!r)return S();if(x||!1!==x&&-1===r.indexOf(k)){for(var f=r.split(M),d=0;d<f.length;d++){if(l=f[d],L+=l.length,d!==f.length-1)L+=M.length;else if(n)return S();if(!O||l.substr(0,a)!==O){if(s){if(c=[],g(l.split(R)),C(),T)return S()}else g(l.split(R));if(I&&I<=d)return c=c.slice(0,I),S(!0)}}return S()}for(var p,y=r.indexOf(R,L),v=r.indexOf(M,L),_=new RegExp(B.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&")+k,"g");;)if(r[L]!==k)if(O&&0===l.length&&r.substr(L,a)===O){if(-1===v)return S();L=v+o,v=r.indexOf(M,L),y=r.indexOf(R,L)}else if(-1!==y&&(y<v||-1===v))l.push(r.substring(L,y)),L=y+e,y=r.indexOf(R,L);else{if(-1===v)break;if(l.push(r.substring(L,v)),E(v+o),s&&(C(),T))return S();if(I&&c.length>=I)return S(!0)}else for(p=L,L++;;){if(-1===(p=r.indexOf(k,p+1)))return n||u.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:c.length,index:L}),P();if(p===i-1)return P(r.substring(L,p).replace(_,k));if(k!==B||r[p+1]!==B){if(k===B||0===p||r[p-1]!==B){var m=w(y);if(r[p+1+m]===R){l.push(r.substring(L,p).replace(_,k)),L=p+1+m+e,y=r.indexOf(R,L),v=r.indexOf(M,L);break}var b=w(v);if(r.substr(p+1+b,o)===M){if(l.push(r.substring(L,p).replace(_,k)),E(p+1+b+o),y=r.indexOf(R,L),s&&(C(),T))return S();if(I&&c.length>=I)return S(!0);break}u.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:c.length,index:L}),p++}}else p++}return P();function g(e){c.push(e),h=L}function w(e){var t=0;if(-1!==e){var n=r.substring(p+1,e);n&&""===n.trim()&&(t=n.length)}return t}function P(e){return n||(void 0===e&&(e=r.substr(L)),l.push(e),L=i,g(l),s&&C()),S()}function E(e){L=e,g(l),l=[],v=r.indexOf(M,L)}function S(e){return{data:c,errors:u,meta:{delimiter:R,linebreak:M,aborted:T,truncated:!!e,cursor:h+(t||0)}}}function C(){A(S()),c=[],u=[]}},this.abort=function(){T=!0},this.getCharIndex=function(){return L}}function b(e){var t=e.data,n=c[t.workerId],r=!1;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var i={abort:function(){r=!0,g(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:w,resume:w};if(U(n.userStep)){for(var o=0;o<t.results.data.length&&(n.userStep({data:[t.results.data[o]],errors:t.results.errors,meta:t.results.meta},i),!r);o++);delete t.results}else U(n.userChunk)&&(n.userChunk(t.results,i,t.file),delete t.results)}t.finished&&!r&&g(t.workerId,t.results)}function g(e,t){var n=c[e];U(n.userComplete)&&n.userComplete(t),n.terminate(),delete c[e]}function w(){throw"Not implemented."}function P(e){if("object"!=typeof e)return e;var t=e instanceof Array?[]:{};for(var n in e)t[n]=P(e[n]);return t}function E(e,t){return function(){e.apply(t,arguments)}}function U(e){return"function"==typeof e}return s?l.onmessage=function(e){var t=e.data;void 0===v.WORKER_ID&&t&&(v.WORKER_ID=t.workerId);if("string"==typeof t.input)l.postMessage({workerId:v.WORKER_ID,results:v.parse(t.input,t.config),finished:!0});else if(l.File&&t.input instanceof File||t.input instanceof Object){var n=v.parse(t.input,t.config);n&&l.postMessage({workerId:v.WORKER_ID,results:n,finished:!0})}}:v.WORKERS_SUPPORTED&&(e=document.getElementsByTagName("script"),o=e.length?e[e.length-1].src:"",document.body?document.addEventListener("DOMContentLoaded",function(){a=!0},!0):a=!0),(d.prototype=Object.create(f.prototype)).constructor=d,(p.prototype=Object.create(f.prototype)).constructor=p,(y.prototype=Object.create(y.prototype)).constructor=y,(_.prototype=Object.create(f.prototype)).constructor=_,v},"function"==typeof define&&define.amd?define([],i):"object"==typeof t&&void 0!==n?t.exports=i():r.Papa=i()},{}]},{},[1]);
//# sourceMappingURL=app-flyweb-client.js.map
